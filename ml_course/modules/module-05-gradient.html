<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 05: Gradient Descent | ML Intuition</title>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-main: #0f172a;
            --accent-red: #ef4444;
            --dark-slate: #1e293b;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; color: var(--text-main); line-height: 1.6; }
        header { background: var(--dark-slate); color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .nav-btn { background: rgba(255,255,255,0.1); color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; text-decoration: none; }
        .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
        
        .simulation-area {
            background: #0f172a;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            color: white;
        }

        canvas {
            width: 100%;
            height: 400px;
            background: #1e293b;
            border-radius: 8px;
        }

        .controls {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            align-items: center;
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 8px;
        }

        .btn-primary { background: #3b82f6; color: white; padding: 0.75rem 1.5rem; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; }
        #toast { position: fixed; bottom: 2rem; right: 2rem; background: var(--dark-slate); color: white; padding: 1rem 1.5rem; border-radius: 8px; transform: translateY(200%); transition: transform 0.3s; }
        #toast.show { transform: translateY(0); }
    </style>
</head>
<body>
    <header>
        <div>
            <a href="../index.html" class="nav-btn">‚Üê Hub</a>
            <span style="margin-left: 1rem; font-weight: bold;">Module 05: Gradient Descent</span>
        </div>
    </header>

    <main class="container">
        <h1>Learning by Falling</h1>
        <p>Gradient Descent is how models minimize error. It's like finding the bottom of a valley in the fog by feeling the slope under your feet.</p>

        <div class="simulation-area">
            <canvas id="gradientCanvas"></canvas>
            <div class="controls">
                <label>Learning Rate: <input type="range" id="lrSlider" min="0.01" max="0.5" step="0.01" value="0.1"></label>
                <span id="lrValue">0.1</span>
                <button class="btn-primary" onclick="startDescent()">Start Descent</button>
                <button class="btn-primary" style="background: #64748b;" onclick="resetSim()">Reset</button>
            </div>
        </div>

        <div style="margin-top: 4rem; text-align: center;">
            <button id="completionBtn" class="btn-primary" style="background: #10b981; padding: 1rem 2rem;">Finish Course</button>
        </div>
    </main>

    <div id="toast">Course Complete!</div>

    <script>
        const canvas = document.getElementById('gradientCanvas');
        const ctx = canvas.getContext('2d');
        let ballX = 50;
        let isRunning = false;
        let lr = 0.1;

        function f(x) {
            // A simple bowl shape: y = (x-200)^2 / 100 + 100
            return Math.pow(x - canvas.width/2, 2) / 100 + 100;
        }

        function df(x) {
            // Derivative: y' = 2(x-200) / 100
            return (2 * (x - canvas.width/2)) / 100;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw valley
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 3;
            ctx.beginPath();
            for(let x=0; x<canvas.width; x++) {
                ctx.lineTo(x, canvas.height - f(x));
            }
            ctx.stroke();

            // Draw ball
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(ballX, canvas.height - f(ballX) - 10, 10, 0, Math.PI*2);
            ctx.fill();
        }

        function startDescent() {
            if (isRunning) return;
            isRunning = true;
            lr = parseFloat(document.getElementById('lrSlider').value);
            animate();
        }

        function animate() {
            if (!isRunning) return;
            
            let gradient = df(ballX);
            ballX -= gradient * lr * 50; // Scaled for visual speed

            draw();

            if (Math.abs(gradient) > 0.1) {
                requestAnimationFrame(animate);
            } else {
                isRunning = false;
            }
        }

        function resetSim() {
            isRunning = false;
            ballX = 50;
            draw();
        }

        window.addEventListener('resize', () => {
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
            draw();
        });

        document.getElementById('lrSlider').addEventListener('input', (e) => {
            document.getElementById('lrValue').textContent = e.target.value;
        });

        document.getElementById('completionBtn').addEventListener('click', () => {
            const progress = JSON.parse(localStorage.getItem('ml_course_progress') || '{}');
            progress['module-05'] = true;
            localStorage.setItem('ml_course_progress', JSON.stringify(progress));
            document.getElementById('toast').classList.add('show');
            setTimeout(() => window.location.href = '../index.html', 1500);
        });

        canvas.width = canvas.clientWidth;
        canvas.height = canvas.clientHeight;
        draw();
    </script>
</body>
</html>

